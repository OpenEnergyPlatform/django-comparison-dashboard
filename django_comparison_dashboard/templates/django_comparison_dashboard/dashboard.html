{% extends "base.html" %}

{% load partials %}

{% block content %}
  <div class="column">
    <!-- Scenario Selection Forms -->
    <div class="align-center">
      <p class="lead mb-3 ml-0">Welcome</p>
      <hr />
      <form hx-post="{% url 'django_comparison_dashboard:filters' %}"
            hx-target="#filters"
            hx-swap="innerHTML">
        {{ scenario_form.as_div }}
        <button type="submit" class="btn btn-primary mt-2">Submit</button>
      </form>
    </div>
    <!-- Content with Filter / Presentation Tab and Charts -->
    <div class="row align-center">
      <!-- contains Filter / Presentation Tab -->
      <div id="content" class="col-6">
        <!-- Tab for Filters -->
        <div id="filters">
          <!-- General Filter Selection -->
          {% startpartial filters inline=True %}
          <form method="get"
                hx-get="{% url 'django_comparison_dashboard:data_table' %}"
                hx-target="#table">
            {% for scenario in scenarios %}<input type="hidden" name="scenario_id" value="{{ scenario }}" />{% endfor %}
            {{ filter_form.form.as_p }}
            <hr />
            {{ order_aggregation_form.as_p }}
            <input type="submit" value="Apply Filters" />
          </form>
        {% endpartial %}
      </div>
    </div>
    <!-- contains Charts and Chart Settings -->
    <div id="chart-column" class="col-6">
      <p>CHARTS !</p>
      {% startpartial graph_options inline=True %}
      <form method="get"
            hx-get="{% url 'django_comparison_dashboard:data_plot' %}"
            hx-include="#filters"
            hx-target="#plot">
        {{ graph_options_form.as_p }}
        <input type="submit" value="Apply Filters" />
      </form>
    {% endpartial %}
    <div id="plot"></div>
    <div id="table"></div>
  </div>
</div>
</div>
{% endblock content %}
{% block javascript %}
  {{ block.super }}
  <script src="https://unpkg.com/htmx.org@1.9.7"></script>
{% endblock javascript %}
