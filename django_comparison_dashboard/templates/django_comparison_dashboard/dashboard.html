{% extends "base.html" %}

{% load partials %}

{% block content %}
  <div class="column">
    <!-- Scenario Selection Forms -->
    <div class="align-center">
      <p class="lead mb-3 ml-0">Welcome</p>
      <hr />
    </div>
    <form method="get" action="{% url 'django_comparison_dashboard:load' %}">
      {% for scenario in scenarios %}<input type="hidden" name="scenario_id" value="{{ scenario }}" />{% endfor %}
      <input type="text" id="load_settings" name="name" label="name" />
      <input type="submit" value="Load Filter Settings" />
    </form>
    <!-- Content with Filter / Presentation Tab and Charts -->
    <div class="row align-center">
      <!-- contains Filter / Presentation Tab -->
      <div id="content" class="col-6">
        <!-- Tab for Filters -->
        <div id="filters">
          <!-- General Filter Selection -->
          {% startpartial filters inline=True %}
          <form method="get"
                hx-get="{% url 'django_comparison_dashboard:data_table' %}"
                hx-target="#table">
            {% for scenario in scenarios %}<input type="hidden" name="scenario_id" value="{{ scenario }}" />{% endfor %}
            {{ scenario_filter.form.as_p }}
            <hr />
            {{ order_aggregation_form.as_p }}
            <hr />
            {{ unit_form.as_p }}
            <hr />
            {% startpartial labels inline=True %}
            <div>
              {{ label_form.as_p }}
              <button _="on click remove my.parentElement">X</button>
            </div>
          {% endpartial %}
          <div id="more_labels"></div>
          <button type="button"
                  hx-get="{% url 'django_comparison_dashboard:add_label_form' %}"
                  hx-target="#more_labels"
                  hx-swap="beforeend">Add another Label</button>
          <hr />
          <input type="submit" value="Apply Filters" />
        </form>
      {% endpartial %}
    </div>
  </div>
  <!-- contains Charts and Chart Settings -->
  <div id="chart-column" class="col-6">
    <p>CHARTS !</p>
    <div id="graph_options">
      {% startpartial graph_options inline=True %}
      <form method="get"
            hx-get="{% url 'django_comparison_dashboard:data_plot' %}"
            hx-include="#filters"
            hx-target="#plot">
        {{ graph_options_form.as_p }}
        <hr />
        <p>Display Options</p>
        {{ display_options_form.as_p }}
        <hr />
        {% startpartial colors inline=True %}
        <div>
          {{ color_form.as_p }}
          <button _="on click remove my.parentElement">X</button>
        </div>
      {% endpartial %}
      <div id="more_colors"></div>
      <button type="button"
              hx-get="{% url 'django_comparison_dashboard:add_color_form' %}"
              hx-target="#more_colors"
              hx-swap="beforeend">Add another Color</button>
      <input type="submit" value="Apply Filters" />
    </form>
  {% endpartial %}
</div>
<div id="plot"></div>
<div id="table"></div>
</div>
<form hx-post="{% url 'django_comparison_dashboard:save' %}"
      hx-include="#filters, #graph_options"
      hx-swap="none">
  <input type="text" id="save_settings" name="name" label="name" />
  <input type="submit" value="Save Filter Settings" />
</form>
</div>
</div>
{% endblock content %}
{% block javascript %}
  {{ block.super }}
  <script src="https://unpkg.com/htmx.org@1.9.7"></script>
  <script src="https://unpkg.com/hyperscript.org@0.9.12"></script>
{% endblock javascript %}
